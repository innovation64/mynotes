---
{"dg-publish":true,"permalink":"/rl-column/hf-chapter1/1-3/","dgPassFrontmatter":true,"noteIcon":"data:image/webp;base64,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"}
---


# 强化学习框架 [[the-reinforcement-learning-framework\|the-reinforcement-learning-framework]]

## RL 过程 [[the-rl-process\|the-rl-process]]

<figure>
<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/RL_process.jpg" alt="The RL process" width="100%">
<figcaption>RL 过程：状态、动作、奖励和下一个状态的循环</figcaption>
<figcaption>来源：<a href="http://incompleteideas.net/book/RLbook2020.pdf">强化学习：导论，Richard Sutton 和 Andrew G. Barto</a></figcaption>
</figure>

为了理解 RL 过程，让我们想象一个智能体在玩平台游戏：

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/RL_process_game.jpg" alt="The RL process" width="100%">

- 我们的智能体从**环境**接收到**状态\\(S_0\\)**——我们收到游戏的第一帧（环境）。
- 基于**状态\\(S_0\\)，**智能体采取**动作\\(A_0\\)**——我们的智能体将向右移动。
- 环境进入 **新** **状态 \\(S_1\\)** - 新的一帧。
- 环境给智能体一些**奖励 \\(R_1\\)** - 我们没有死*（正奖励 +1）*。

此 RL 循环输出一系列**状态、动作、奖励和下一个状态。** 

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/sars.jpg" alt="State, Action, Reward, Next State" width="100%">

智能体的目标是_最大化_其累积奖励，**称为期望回报。**

## 奖励假设：强化学习的核心思想[[奖励假设\|奖励假设]]

⇒ 为什么智能体的目标是最大化期望回报？

因为 RL 是基于**奖励假设**，即所有目标都可以描述为**期望回报**（期望累积奖励）的最大化。

这就是为什么在强化学习中，**为了获得最佳行为**，我们的目标是学习采取动作以**最大化期望累积奖励。**


## 马尔可夫性质 [[马尔可夫性质\|马尔可夫性质]]

在论文中，你会看到 RL 过程称为**马尔可夫决策过程** (Markov Decision Process，MDP)。

我们将在以下单元中再次讨论马尔可夫性质。但是如果你今天需要记住一些关于它的事情，那就是：马尔可夫性质意味着我们的智能体需要**只根据当前状态来决定**采取什么动作，**而不是根据所有状态和动作的历史采取动作**。

## 观测/状态空间 [[obs-space\|obs-space]]

观测/状态是我们的智能体从环境中获取的**信息。**在视频游戏的情况下，它可以是一帧（屏幕截图）。在交易智能体的情况下，它可以是某只股票的价值等。

*观测* 和 *状态* 之间是有区别的，但是：

- *状态s*：是**对世界状态的完整描述**（没有隐藏信息）。在完全可观测的环境中。


<figure>
<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/chess.jpg" alt="Chess">
<figcaption>在国际象棋游戏中，由于我们可以访问整个棋盘信息，因此我们从环境中接收状态。</figcaption>
</figure>

在国际象棋游戏中，我们可以访问整个棋盘信息，因此我们从环境中接收到一个状态。换句话说，环境被完全观测到。

- *观测 o*：是对状态的**部分描述。**在部分可观测的环境中。

<figure>
<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/mario.jpg" alt="Mario">
<figcaption>在《超级马里奥》中，我们只能看到靠近玩家的部分关卡（level），因此我们接收的是一个观测。</figcaption>
</figure>

在《超级马里奥》中，我们只能看到靠近玩家的部分关卡，因此我们接收的是一个观测。

在《超级马里奥》中，我们处于一个部分可观测的环境中。**因为我们只看到了关卡的一部分**所以我们只收到一个观测。

<tip>
在本课程中，我们使用术语“状态”来表示状态和观测，但我们将在实现中加以区分。
</tip>

回顾一下：
<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/obs_space_recap.jpg" alt="Obs space recap" width="100%">


## 动作空间 [[动作空间\|动作空间]]

动作空间是**环境中所有可能动作的集合。**

动作可以来自*离散*或*连续空间*：

- *离散空间*：可能动作数量是**有限的**。

<figure>
<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/mario.jpg" alt="Mario">
<figcaption>同样，在《超级马里奥》中，我们只有 4 种可能的动作：左，右，上（跳跃），下（蹲着）/figcaption>

</figure>

在《超级马里奥》中，我们只有一组有限的动作，因为我们只有 4 个方向。

- *连续空间*：可能的动作数量是**无限**。

<figure>
<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/self_driving_car.jpg" alt="Self Driving Car">
<figcaption>自动驾驶汽车智能体有无数种可能的动作，因为它可以左转 20°、21.1°、21.2°、鸣喇叭、右转 20°……
</figcaption>
</figure>

回顾一下：
<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/action_space.jpg" alt="Action space recap" width="100%">

考虑这些信息至关重要，因为它**在将来选择 RL 算法时非常重要。**

## 奖励和折扣 [[rewards\|rewards]]

奖励是 RL 的基础，因为它是智能体的**唯一反馈**。多亏了它，我们的智能体才知道**所采取的动作是否正确。**

每个时间步的累积奖励 **t** 可以写成：

<figure>
<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/rewards_1.jpg" alt="Rewards">
<figcaption>累计奖励等于该序列所有奖励的总和。
</figcaption>
</figure>

这相当于：

<figure>
<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/rewards_2.jpg" alt="Rewards">
<figcaption>累计奖励 = rt+1 (rt+k+1 = rt+0+1 = rt+1)+ rt+2 (rt+k+1 = rt+1+1 = rt+2) + . ..
</figcaption>
</figure>

然而，在现实中，**我们不能就这样累加。**因为较早出现的奖励（在游戏开始时）**更有可能发生**，所以它们比长期的未来奖励更可预测。

假设你的智能体是这只小老鼠，每一步可以移动一个方块，而你的对手是猫（它也可以移动）。老鼠的目标是**在被猫吃掉之前吃掉最多的奶酪。**

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/rewards_3.jpg" alt="Rewards" width="100%">

正如我们在图中看到的，**吃掉我们附近的奶酪的可能性比吃靠近猫的奶酪的可能性更大**（我们离猫越近，它就越危险）。

因此，**即使猫附近的奖励更大（更多奶酪），折扣也会更多**，因为我们不确定是否能够吃掉它。

为了折扣奖励，我们这样做：

1. 我们定义一个称为 γ 的折扣率，**其必须介于 0 和 1 之间。** 大多数情况下介于 **0.95 和 0.99** 之间。
- γ 越大，折扣越小。这意味着我们的智能体**更关心长期奖励。**
- 另一方面， γ 越小，折扣越大。这意味着我们的 **智能体 更关心短期奖励（最近的奶酪）。**

2. 然后，每个奖励将通过 γ 时间步数的指数来打折扣。随着时间步数的增加，猫离我们越来越近，**因此未来奖励发生的可能性越来越小。**

我们的折扣期望累积奖励是：
<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/rewards_4.jpg" alt="Rewards" width="100%">